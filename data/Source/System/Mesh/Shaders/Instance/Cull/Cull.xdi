<?xml version="1.0" encoding="utf-8"?>
<object type="traktor.render.ShaderGraph" version="traktor.render.Graph:1">
	<nodes>
		<item type="traktor.render.DispatchIndex" version="1,traktor.render.Node:1">
			<id>{4BAA3A0D-D779-C141-B519-197EEA8640D6}</id>
			<comment/>
			<position>
				<first>-336</first>
				<second>123</second>
			</position>
			<scope>Global</scope>
		</item>
		<item type="traktor.render.Swizzle" version="traktor.render.Node:1">
			<id>{B63DBBD3-72C0-C645-8A24-4893BBF22E30}</id>
			<comment/>
			<position>
				<first>-107</first>
				<second>132</second>
			</position>
			<swizzle>x</swizzle>
		</item>
		<item type="traktor.render.ReadStruct2" version="traktor.render.Node:1">
			<id>{A4DC3ED3-6068-054F-9623-163C10D79FD1}</id>
			<comment/>
			<position>
				<first>85</first>
				<second>56</second>
			</position>
			<names>
				<item>rotation</item>
				<item>translationAndScale</item>
			</names>
		</item>
		<item type="traktor.render.Struct" version="traktor.render.Node:1">
			<id>{7E76A642-57F5-1F4D-90C1-E578206B7057}</id>
			<comment/>
			<position>
				<first>-246</first>
				<second>40</second>
			</position>
			<parameterName>InstanceWorld</parameterName>
			<elements>
				<item>
					<name>rotation</name>
					<type>DtFloat4</type>
				</item>
				<item>
					<name>translationAndScale</name>
					<type>DtFloat4</type>
				</item>
			</elements>
		</item>
		<item type="traktor.render.Swizzle" version="traktor.render.Node:1">
			<id>{FB4B169C-944B-E049-927D-F60F28080923}</id>
			<comment/>
			<position>
				<first>378</first>
				<second>140</second>
			</position>
			<swizzle>w</swizzle>
		</item>
		<item type="traktor.render.Swizzle" version="traktor.render.Node:1">
			<id>{91EC5EF9-EBF6-8546-A91A-4550CAEB6CDE}</id>
			<comment/>
			<position>
				<first>378</first>
				<second>70</second>
			</position>
			<swizzle>xyz</swizzle>
		</item>
		<item type="traktor.render.Uniform" version="3,traktor.render.Node:1">
			<id>{91A1C374-33C8-6F4C-B0E5-0D7C530C3452}</id>
			<comment/>
			<position>
				<first>383</first>
				<second>388</second>
			</position>
			<parameterName>World_View</parameterName>
			<type>Matrix</type>
			<frequency>Frame</frequency>
		</item>
		<item type="traktor.render.Uniform" version="3,traktor.render.Node:1">
			<id>{012016E9-7DB1-D849-AF8D-3641CE8D9C6C}</id>
			<comment/>
			<position>
				<first>271</first>
				<second>306</second>
			</position>
			<parameterName>InstanceMesh_BoundingBoxMin</parameterName>
			<type>Vector</type>
			<frequency>Frame</frequency>
		</item>
		<item type="traktor.render.Uniform" version="3,traktor.render.Node:1">
			<id>{0A7FA3F8-E334-3247-8BFD-E2CD797A56DF}</id>
			<comment/>
			<position>
				<first>271</first>
				<second>347</second>
			</position>
			<parameterName>InstanceMesh_BoundingBoxMax</parameterName>
			<type>Vector</type>
			<frequency>Frame</frequency>
		</item>
		<item type="traktor.render.Script" version="6,traktor.render.Node:1">
			<id>{A12CD3AB-ABC5-BE47-882A-206186C7504A}</id>
			<comment/>
			<position>
				<first>722</first>
				<second>340</second>
			</position>
			<name>Frustum</name>
			<technique/>
			<localSize>
				<X>1</X>
				<Y>1</Y>
				<Z>1</Z>
			</localSize>
			<include>
				<item>{45D674A1-6AC4-6B4E-B7CB-DC7F9C2EC215}</item>
			</include>
			<inputPins>
				<item>
					<id>{33456A85-8F14-3C42-AB81-C4A420295395}</id>
					<name>Bbmn</name>
				</item>
				<item>
					<id>{81D145C3-26D6-1D41-BA2D-A7787763BF44}</id>
					<name>Bbmx</name>
				</item>
				<item>
					<id>{FCE979D2-93DF-EB41-A77E-8ED2EA00ED32}</id>
					<name>Translation</name>
				</item>
				<item>
					<id>{FCA0A9DD-854C-A84B-8EA1-027FB3FBBA4A}</id>
					<name>View</name>
				</item>
				<item>
					<id>{A7438956-AAFD-EB40-ADC9-B21E773A81CD}</id>
					<name>F</name>
				</item>
			</inputPins>
			<outputPins>
				<item>
					<id>{C2E0B588-DBCB-F04B-9978-8C1B6593F31A}</id>
					<name>Output</name>
					<type>Scalar</type>
				</item>
			</outputPins>
			<script>
			<![CDATA[
const vec3 center = ($Bbmn + $Bbmx).xyz / 2.0f;
const float radius = length(($Bbmx - $Bbmn).xyz / 2.0f);

const vec3 worldCenter = $Translation.xyz + center;
const vec4 viewCenter = $View * vec4(worldCenter, 1.0f);

bool inside0, inside1;

{
	Frustum f;
	f.planes[0] = $F[0];
	f.planes[1] = $F[1];
	f.planes[2] = $F[2];
	f.planes[3] = $F[3];
	f.planes[4] = $F[4];
	f.planes[5] = $F[5];
	inside0 = FrustumInside(f, viewCenter.xyz, radius);
}
{
	Frustum f;
	f.planes[0] = $F[6];
	f.planes[1] = $F[7];
	f.planes[2] = $F[8];
	f.planes[3] = $F[9];
	f.planes[4] = $F[10];
	f.planes[5] = $F[11];
	inside1 = FrustumInside(f, viewCenter.xyz, radius);
}

$Output = (inside0 && inside1) ? 1.0f : 0.0f;
			]]>
			</script>
		</item>
		<item type="traktor.render.Script" version="6,traktor.render.Node:1">
			<id>{861D7610-0664-6C4B-A21F-0D64852C2041}</id>
			<comment/>
			<position>
				<first>1572</first>
				<second>363</second>
			</position>
			<name>WriteOut</name>
			<technique>Default</technique>
			<localSize>
				<X>16</X>
				<Y>1</Y>
				<Z>1</Z>
			</localSize>
			<include/>
			<inputPins>
				<item>
					<id>{AF60E34F-9E23-4E4B-8874-3FCB33F46C2F}</id>
					<name>Buffer</name>
				</item>
				<item>
					<id>{13DDFE53-988C-FE40-B343-7FE23D25E253}</id>
					<name>Index</name>
				</item>
				<item>
					<id>{89D6EAF6-DAAD-C647-B640-7F86B233A509}</id>
					<name>Input</name>
				</item>
			</inputPins>
			<outputPins/>
			<script>
			<![CDATA[
const int index = int($Index);

$Buffer[index].visible = $Input;
			]]>
			</script>
		</item>
		<item type="traktor.render.Struct" version="traktor.render.Node:1">
			<id>{32AF829B-BE26-9242-99ED-1189D698205D}</id>
			<comment/>
			<position>
				<first>1286</first>
				<second>371</second>
			</position>
			<parameterName>InstanceMesh_Visibility</parameterName>
			<elements>
				<item>
					<name>visible</name>
					<type>DtFloat1</type>
				</item>
			</elements>
		</item>
		<item type="traktor.render.IndexedUniform" version="3,traktor.render.Node:1">
			<id>{91A8C6C3-38AF-0E49-9137-BEB73CB41DD4}</id>
			<comment/>
			<position>
				<first>223</first>
				<second>548</second>
			</position>
			<parameterName>InstanceMesh_CullFrustum</parameterName>
			<type>Vector</type>
			<frequency>Frame</frequency>
			<length>12</length>
		</item>
		<item type="traktor.render.Branch" version="traktor.render.Node:1">
			<id>{2524AA09-8565-774A-B5BA-F09DAE6026BD}</id>
			<comment/>
			<position>
				<first>1212</first>
				<second>579</second>
			</position>
			<parameterName>InstanceMesh_HiZ</parameterName>
		</item>
		<item type="traktor.render.Uniform" version="3,traktor.render.Node:1">
			<id>{6FAE432D-36E8-D046-96BA-65165BB9DCCC}</id>
			<comment/>
			<position>
				<first>422</first>
				<second>818</second>
			</position>
			<parameterName>World_HiZTexture</parameterName>
			<type>Texture2D</type>
			<frequency>Frame</frequency>
		</item>
		<item type="traktor.render.Script" version="6,traktor.render.Node:1">
			<id>{B3BCC5CA-6F48-3A42-BB0C-3DE19CDFE7DF}</id>
			<comment/>
			<position>
				<first>721</first>
				<second>756</second>
			</position>
			<name>HiZ</name>
			<technique/>
			<localSize>
				<X>1</X>
				<Y>1</Y>
				<Z>1</Z>
			</localSize>
			<include>
				<item>{45D674A1-6AC4-6B4E-B7CB-DC7F9C2EC215}</item>
			</include>
			<inputPins>
				<item>
					<id>{38213B60-FC63-A541-BCC2-95E414C2276D}</id>
					<name>Bbmn</name>
				</item>
				<item>
					<id>{484ABC89-3116-A645-8DEB-1DD2AD5B66E9}</id>
					<name>Bbmx</name>
				</item>
				<item>
					<id>{1384E810-955D-844D-B29B-91D1A448D1AC}</id>
					<name>Translation</name>
				</item>
				<item>
					<id>{38C7084D-4F8D-D749-A614-108D37B2EF5D}</id>
					<name>View</name>
				</item>
				<item>
					<id>{2D477B25-59BB-AB41-AD8A-B373447C47C4}</id>
					<name>Projection</name>
				</item>
				<item>
					<id>{B53AF0D1-D6CC-9A40-9334-2C4CD642EE5B}</id>
					<name>HiZTexture</name>
				</item>
				<item>
					<id>{6D0649E3-ED26-0646-A195-028038D29BD8}</id>
					<name>HiZState</name>
				</item>
				<item>
					<id>{652EFABE-595D-9D4D-BC67-5C63D6168B21}</id>
					<name>TargetSize</name>
				</item>
			</inputPins>
			<outputPins>
				<item>
					<id>{5D1C8949-65AE-2046-A34D-469B22E09B20}</id>
					<name>Output</name>
					<type>Scalar</type>
				</item>
			</outputPins>
			<script>
			<![CDATA[
const vec3 center = ($Bbmn + $Bbmx).xyz / 2.0f;
const float radius = length(($Bbmx - $Bbmn).xyz) / 2.0f;

const vec3 worldCenter = $Translation.xyz + center;
const vec4 viewCenter = $View * vec4(worldCenter, 1.0f);

bool visible = true;

const float znear = 0.1f;
const float P00 = $Projection[0][0];
const float P11 = $Projection[1][1];

vec4 aabb;
if (ProjectSphere(viewCenter.xyz, radius, znear, P00, P11, aabb))
{
	const vec2 hs = textureSize($HiZTexture, 0);
	const ivec2 osz = ivec2($TargetSize.xy) / 2;

	const float width = (aabb.z - aabb.x) * osz.x;
	const float height = (aabb.w - aabb.y) * osz.y;
	const float level = ceil(log2(max(width, height)));

	vec2 s = vec2(osz) / hs;
	vec2 p = ((aabb.xy + aabb.zw) * 0.5f) * s;

	const float depth = textureLod(sampler2D($HiZTexture, $HiZState), p, level).x;

	const float depthSphere = viewCenter.z - radius;
	visible = depthSphere <= depth;
}

$Output = visible ? 1.0f : 0.0f;

			]]>
			</script>
		</item>
		<item type="traktor.render.Uniform" version="3,traktor.render.Node:1">
			<id>{E6AAA1C9-EEBE-3143-A4AB-7A05E14E17AB}</id>
			<comment/>
			<position>
				<first>422</first>
				<second>776</second>
			</position>
			<parameterName>World_Projection</parameterName>
			<type>Matrix</type>
			<frequency>Frame</frequency>
		</item>
		<item type="traktor.render.TextureState" version="traktor.render.Node:1">
			<id>{7B83C271-F045-4343-9666-B5DC8E2A479D}</id>
			<comment/>
			<position>
				<first>440</first>
				<second>860</second>
			</position>
			<minFilter>FtPoint</minFilter>
			<mipFilter>FtPoint</mipFilter>
			<magFilter>FtPoint</magFilter>
			<addressU>AdClamp</addressU>
			<addressV>AdClamp</addressV>
			<addressW>AdClamp</addressW>
			<compare>CfNone</compare>
			<mipBias>0</mipBias>
			<ignoreMips>false</ignoreMips>
			<useAnisotropic>false</useAnisotropic>
		</item>
		<item type="traktor.render.Mul" version="traktor.render.Node:1">
			<id>{B2B588B8-DCC2-004F-AE5B-672497EEBFAB}</id>
			<comment/>
			<position>
				<first>1011</first>
				<second>651</second>
			</position>
		</item>
		<item type="traktor.render.Uniform" version="3,traktor.render.Node:1">
			<id>{2095B07F-6B63-D845-B825-6F4B49DCE4DA}</id>
			<comment/>
			<position>
				<first>374</first>
				<second>902</second>
			</position>
			<parameterName>InstanceMesh_TargetSize</parameterName>
			<type>Vector</type>
			<frequency>Frame</frequency>
		</item>
	</nodes>
	<edges>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item"/>
				<id>{AAE82FD3-522F-43C6-A594-2E13D126E5DB}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[1]"/>
				<id>{F2E22CA6-DFF3-4B20-A70A-0D7A44EACD8C}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[3]"/>
				<id>{ACC77B35-91B5-4405-ABC8-D0DA24D68178}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[2]"/>
				<id>{0FF6511C-0293-41A8-830E-81978BD01F7F}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[1]"/>
				<id>{ADB4FC1D-3726-4CC5-B4D5-1E2468274325}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[2]"/>
				<id>{0FF6511C-0293-41A8-840E-81978BD01F7F}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[2]"/>
				<id>{0FF6511C-0293-41A8-860E-81978BD01F7F}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[5]"/>
				<id>{F2E22CA6-DFF3-4B20-A70A-0D7A44EACD8C}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[2]"/>
				<id>{0FF6511C-0293-41A8-860E-81978BD01F7F}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[4]"/>
				<id>{F2E22CA6-DFF3-4B20-A70A-0D7A44EACD8C}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[5]"/>
				<id>{ADB4FC1D-3726-4CC5-B4D5-1E2468274325}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[9]"/>
				<id>{FCE979D2-93DF-EB41-A77E-8ED2EA00ED32}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[6]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[9]"/>
				<id>{FCA0A9DD-854C-A84B-8EA1-027FB3FBBA4A}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[7]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[9]"/>
				<id>{33456A85-8F14-3C42-AB81-C4A420295395}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[8]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[9]"/>
				<id>{81D145C3-26D6-1D41-BA2D-A7787763BF44}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[11]"/>
				<id>{ACC77B35-91B5-4405-ABC8-D0DA24D68178}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[10]"/>
				<id>{AF60E34F-9E23-4E4B-8874-3FCB33F46C2F}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[1]"/>
				<id>{ADB4FC1D-3726-4CC5-B4D5-1E2468274325}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[10]"/>
				<id>{13DDFE53-988C-FE40-B343-7FE23D25E253}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[12]"/>
				<id>{410A240E-17E1-40F0-82FE-BB8ECD086DCA}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[9]"/>
				<id>{A7438956-AAFD-EB40-ADC9-B21E773A81CD}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[9]"/>
				<id>{C2E0B588-DBCB-F04B-9978-8C1B6593F31A}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[13]"/>
				<id>{92AA3735-BB4C-4541-81DA-AC500930B2E6}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[13]"/>
				<id>{9D9FA2FC-9298-4A6F-88A9-A055F8A91F52}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[10]"/>
				<id>{89D6EAF6-DAAD-C647-B640-7F86B233A509}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[7]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[15]"/>
				<id>{38213B60-FC63-A541-BCC2-95E414C2276D}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[8]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[15]"/>
				<id>{484ABC89-3116-A645-8DEB-1DD2AD5B66E9}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[6]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[15]"/>
				<id>{38C7084D-4F8D-D749-A614-108D37B2EF5D}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[5]"/>
				<id>{ADB4FC1D-3726-4CC5-B4D5-1E2468274325}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[15]"/>
				<id>{1384E810-955D-844D-B29B-91D1A448D1AC}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[16]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[15]"/>
				<id>{2D477B25-59BB-AB41-AD8A-B373447C47C4}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[14]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[15]"/>
				<id>{B53AF0D1-D6CC-9A40-9334-2C4CD642EE5B}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[17]"/>
				<id>{82C966B2-7B19-48B2-8FE0-B85FF4E3C504}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[15]"/>
				<id>{6D0649E3-ED26-0646-A195-028038D29BD8}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[15]"/>
				<id>{5D1C8949-65AE-2046-A34D-469B22E09B20}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[18]"/>
				<id>{D2D716D6-C4A1-471F-894A-D718515F6281}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[9]"/>
				<id>{C2E0B588-DBCB-F04B-9978-8C1B6593F31A}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[18]"/>
				<id>{69997292-C813-490C-910C-620B9AD3A2BB}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[18]"/>
				<id>{9E839249-E9B9-4736-8BDD-A95A1C892B42}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[13]"/>
				<id>{A1DDB166-9422-45A3-AE93-6702275DAD1C}</id>
			</destination>
		</item>
		<item type="traktor.render.Edge" version="1">
			<source>
				<node ref="/object/nodes/item[19]"/>
				<id>{1E6639B6-8B58-4694-99E7-C058E3583522}</id>
			</source>
			<destination>
				<node ref="/object/nodes/item[15]"/>
				<id>{652EFABE-595D-9D4D-BC67-5C63D6168B21}</id>
			</destination>
		</item>
	</edges>
	<groups/>
</object>
