<?xml version="1.0" encoding="utf-8"?>
<object type="traktor.world.PostProcessSettings" version="1">
	<requireHighRange>true</requireHighRange>
	<definitions>
    <!-- Luminance target -->
		<item type="traktor.world.PostProcessDefineTarget">
			<id>1</id>
			<width>0</width>
			<height>0</height>
			<screenDenom>8</screenDenom>
			<format>TfR32F</format>
			<depthStencil>false</depthStencil>
			<multiSample>0</multiSample>
		</item>
    
    <!-- Luminance target, downsample 1 -->
    <item type="traktor.world.PostProcessDefineTarget">
      <id>2</id>
      <width>64</width>
      <height>64</height>
      <screenDenom>0</screenDenom>
      <format>TfR32F</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>

    <!-- Luminance target, downsample 2 -->
    <item type="traktor.world.PostProcessDefineTarget">
      <id>3</id>
      <width>16</width>
      <height>16</height>
      <screenDenom>0</screenDenom>
      <format>TfR32F</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>

    <!-- Luminance target, downsample 3 -->
    <item type="traktor.world.PostProcessDefineTarget">
      <id>4</id>
      <width>4</width>
      <height>4</height>
      <screenDenom>0</screenDenom>
      <format>TfR32F</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>
    
    <!-- Luminance target, downsample 4, frame luminance -->
    <item type="traktor.world.PostProcessDefineTarget">
      <id>5</id>
      <width>1</width>
      <height>1</height>
      <screenDenom>0</screenDenom>
      <format>TfR32F</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>
    
    <!-- Luminance targets, low-pass filtered luminance, "current" -->
    <item type="traktor.world.PostProcessDefineTarget">
      <id>6</id>
      <width>1</width>
      <height>1</height>
      <screenDenom>0</screenDenom>
      <format>TfR32F</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>
    <item type="traktor.world.PostProcessDefineTarget">
      <id>7</id>
      <width>1</width>
      <height>1</height>
      <screenDenom>0</screenDenom>
      <format>TfR32F</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>
    
    <!-- Hi-pass target -->
    <item type="traktor.world.PostProcessDefineTarget">
      <id>8</id>
      <width>0</width>
      <height>0</height>
      <screenDenom>2</screenDenom>
      <format>TfR8G8B8A8</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>
    
    <!-- Blur hi-pass target, horizontal -->
    <item type="traktor.world.PostProcessDefineTarget">
      <id>9</id>
      <width>0</width>
      <height>0</height>
      <screenDenom>2</screenDenom>
      <format>TfR8G8B8A8</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>

    <!-- Blur hi-pass target, vertical -->
    <item type="traktor.world.PostProcessDefineTarget">
      <id>10</id>
      <width>0</width>
      <height>0</height>
      <screenDenom>2</screenDenom>
      <format>TfR8G8B8A8</format>
      <depthStencil>false</depthStencil>
      <multiSample>0</multiSample>
    </item>

  </definitions>
	<steps>
    <!-- Luminance pass -->
		<item type="traktor.world.PostProcessStepSetTarget">
			<target>1</target>
		</item>
		<item type="traktor.world.PostProcessStepSimple">
			<shader>{9B02255F-8C06-1540-AE46-C971346D5B35}</shader>
			<sources>
				<item>
					<param>ColorTexture</param>
					<source>-1</source>
					<index>0</index>
				</item>
			</sources>
		</item>
    
    <!-- Downsample WxH => 64x64 -->
    <item type="traktor.world.PostProcessStepSetTarget">
      <target>2</target>
    </item>
    <item type="traktor.world.PostProcessStepSimple">
      <shader>{38EF7615-7D9D-BE43-B302-3F213026EE14}</shader>
      <sources>
        <item>
          <param>SourceTexture</param>
          <source>1</source>
          <index>0</index>
        </item>
      </sources>
    </item>
    
    <!-- Downsample 64x64 => 16x16 -->
    <item type="traktor.world.PostProcessStepSetTarget">
      <target>3</target>
    </item>
    <item type="traktor.world.PostProcessStepSimple">
      <shader>{38EF7615-7D9D-BE43-B302-3F213026EE14}</shader>
      <sources>
        <item>
          <param>SourceTexture</param>
          <source>2</source>
          <index>0</index>
        </item>
      </sources>
    </item>

    <!-- Downsample 16x16 => 4x4 -->
    <item type="traktor.world.PostProcessStepSetTarget">
      <target>4</target>
    </item>
    <item type="traktor.world.PostProcessStepSimple">
      <shader>{38EF7615-7D9D-BE43-B302-3F213026EE14}</shader>
      <sources>
        <item>
          <param>SourceTexture</param>
          <source>3</source>
          <index>0</index>
        </item>
      </sources>
    </item>

    <!-- Downsample 4x4 => 1x1 -->
    <item type="traktor.world.PostProcessStepSetTarget">
      <target>5</target>
    </item>
    <item type="traktor.world.PostProcessStepSimple">
      <shader>{38EF7615-7D9D-BE43-B302-3F213026EE14}</shader>
      <sources>
        <item>
          <param>SourceTexture</param>
          <source>4</source>
          <index>0</index>
        </item>
      </sources>
    </item>
    
    <!-- Filter luminance -->
    <item type="traktor.world.PostProcessStepSetTarget">
      <target>7</target>
    </item>
    <item type="traktor.world.PostProcessStepSimple">
      <shader>{E9D34A63-454C-6B4C-A508-009527334A5B}</shader>
      <sources>
        <item>
          <param>SourceTexture</param>
          <source>5</source>
          <index>0</index>
        </item>
        <item>
          <param>CurrentIllumTexture</param>
          <source>6</source>
          <index>0</index>
        </item>
      </sources>
    </item>
    <item type="traktor.world.PostProcessStepSwapTargets">
      <destination>6</destination>
      <source>7</source>
    </item>
    
    <!-- Hi-pass filter -->
    <item type="traktor.world.PostProcessStepSetTarget">
      <target>8</target>
    </item>
    <item type="traktor.world.PostProcessStepSimple">
      <shader>{123D8BD7-1A67-DE4D-AE6E-26D40B57C624}</shader>
      <sources>
        <item>
          <param>ColorTexture</param>
          <source>-1</source>
          <index>0</index>
        </item>
        <item>
          <param>CurrentIllumTexture</param>
          <source>6</source>
          <index>0</index>
        </item>
      </sources>
    </item>
    
    <!-- Blur horizontal -->
    <item type="traktor.world.PostProcessStepSetTarget">
      <target>9</target>
    </item>
    <item type="traktor.world.PostProcessStepBlur">
      <shader>{E119187C-8BF9-6544-934B-44CC29C65A26}</shader>
      <sources>
        <item>
          <param>Source</param>
          <source>8</source>
          <index>0</index>
        </item>
      </sources>
      <direction>2, 0, 0, 0</direction>
    </item>

    <!-- Blur vertical -->
    <item type="traktor.world.PostProcessStepSetTarget">
      <target>10</target>
    </item>
    <item type="traktor.world.PostProcessStepBlur">
      <shader>{E119187C-8BF9-6544-934B-44CC29C65A26}</shader>
      <sources>
        <item>
          <param>Source</param>
          <source>9</source>
          <index>0</index>
        </item>
      </sources>
      <direction>0, 2, 0, 0</direction>
    </item>

    <!-- Composite -->
    <item type="traktor.world.PostProcessStepSetTarget">
			<target>0</target>
		</item>
		<item type="traktor.world.PostProcessStepSimple">
			<shader>{F3963494-CF15-1441-AE32-11A71844B99B}</shader>
			<sources>
        <item>
          <param>ColorTexture</param>
          <source>-1</source>
          <index>0</index>
        </item>
        <item>
					<param>CurrentIllumTexture</param>
					<source>6</source>
					<index>0</index>
				</item>
        <item>
          <param>BloomTexture</param>
          <source>10</source>
          <index>0</index>
        </item>
      </sources>
		</item>
	</steps>
</object>
