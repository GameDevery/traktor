<?xml version="1.0" encoding="utf-8"?>
<object type="traktor.script.Script" version="2">
	<text>
	<![CDATA[
-- Tween

Tween = Tween or class("Tween")

Tween._instances = {}

function Tween:new(startValue, endValue, duration, fn)
	self._startValue = startValue
	self._endValue = endValue
	self._duration = duration
	self._time = 0
	self._fn = fn
	table.insert(Tween._instances, self)
end

function Tween:stop()
	for i, t in ipairs(Tween._instances) do
		if t == self then
			table.remove(Tween._instances, i)
			break
		end
	end
end

function Tween.update(dT)
	local n = #Tween._instances
	local i = 1
	while i <= n do
		local t = Tween._instances[i]
		local k = t._time / t._duration
		local value = t._startValue * (1 - k) + t._endValue * k
		if t._fn ~= nil then
			t._fn(value)
		end
		t._time = t._time + dT
		if t._time <= t._duration then
			i = i + 1
		else
			if t._fn ~= nil then
				t._fn(t._endValue)
			end
			Tween._instances[i] = Tween._instances[n]
			Tween._instances[n] = nil
			n = n - 1
		end
	end
end

	]]>
	</text>
</object>
