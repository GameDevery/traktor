<?xml version="1.0" encoding="utf-8"?>
<object type="traktor.script.Script" version="2">
	<text>
	<![CDATA[
-- Tween

Tween = Tween or {}
Tween_meta = Tween_meta or { name = "Tween", __index = Tween }

Tween._instances = {}

function Tween.new(startValue, endValue, duration, fn)
	local o = {}
	setmetatable(o, Tween_meta)

	o._startValue = startValue
	o._endValue = endValue
	o._duration = duration
	o._time = 0
	o._fn = fn

	table.insert(Tween._instances, o)
	return o
end

function Tween:stop()
	for i, t in ipairs(Tween._instances) do
		if t == self then
			table.remove(Tween._instances, i)
			break
		end
	end
end

function Tween.update(dT)
	local n = #Tween._instances
	local i = 1
	while i <= n do
		local t = Tween._instances[i]
		local k = t._time / t._duration
		local value = t._startValue * (1 - k) + t._endValue * k
		if t._fn ~= nil then
			t._fn(value)
		end
		t._time = t._time + dT
		if t._time <= t._duration then
			i = i + 1
		else
			if t._fn ~= nil then
				t._fn(t._endValue)
			end
			Tween._instances[i] = Tween._instances[n]
			Tween._instances[n] = nil
			n = n - 1
		end
	end
end


	]]>
	</text>
</object>
