<?xml version="1.0" encoding="utf-8"?>
<object type="traktor.script.Script" version="1">
	<dependencies/>
	<text>
	<![CDATA[
-- Splash common script
-- Will exit to "NEXT" stage after 5 seconds.

m_loadAsyncHandle = nil
m_timeUntilNext = 0

function initialize()
	local inputSystem = environment:getInput():getInputSystem()
	local renderView = environment:getRender():getRenderView()

	m_loadAsyncHandle = stage:loadStageAsync("NEXT", nil)
	if m_loadAsyncHandle == nil then
		print("Unable to create async stage loader")
		stage:terminate()
	end

	m_timeUntilNext = 5

	inputSystem:setExclusive(false)
	renderView:showCursor()
end

function update(control, info)
	m_timeUntilNext = m_timeUntilNext - info:getSimulationDeltaTime()
	if m_timeUntilNext < 0 and m_loadAsyncHandle:ready() then
		if m_loadAsyncHandle:succeeded() then
			control:setPause(false)
			stage:gotoStage(m_loadAsyncHandle:get())
		else
			stage:terminate()
		end
	elseif m_timeUntilNext < 0 then
		control:setPause(true)
	end
end

	]]>
	</text>
</object>
