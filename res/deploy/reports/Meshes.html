<html>
	<head>
		<title>Meshes</title>
		<style type="text/css">
			body {
				background-color: #ffffff;
				font-family: Tahoma;
				font-size: 80%;
			}
			table {
				background-color: #f0f0e0;
				border-style: none;
				border-collapse:collapse;
				font-size: 90%;
				width: 100%;
				text-align: left;
			}
			tr, td {
				border: 1px solid #a0a090;
			}
			tr.alt {
				border: 1px solid #a0a090;
				background-color: #e0e0d0;
			}
			tr.total {
				border-style: none;
				background-color: #f5f5e5;
				font-weight: bold;
			}
			th, td {
				padding: 2px;
			}
			th {
				background-color: #f5f5e5;
			}
		</style>
	</head>
	<body>
<?--
		local types = {
			[1] = "MtBlend",
			[2] = "MtIndoor",
			[3] = "MtInstance",
			[4] = "MtPartition",
			[5] = "MtSkinned",
			[6] = "MtStatic",
			[7] = "MtStream"
		}

		local db = Connection.connect("fileName=temp/Pipeline.db")
--?>
		<h1>Meshes</h1>
		<table>
			<tr>
				<th>Path</th>
				<th>Type</th>
				<th>Polygon(s)</th>
				<th>Size (KiB)</th>
			</tr>
<?--
		local index = 0
		local totalSize = 0
		local totalPols = 0

		local rs = db:executeQuery("select * from Report_Mesh order by size desc")
		while rs:next() do
			if index % 2 == 1 then
				output:print("<tr class=\"alt\">")
			else
				output:print("<tr>")
			end

			output:print("<td>" .. rs:getStringByName("path") .. "</td>")
			output:print("<td>" .. types[rs:getInt32ByName("type")] .. "</td>")
			output:print("<td>" .. rs:getInt32ByName("polygonCount") .. "</td>")
			output:print("<td>" .. math.ceil(rs:getInt32ByName("size") / 1024) .. "</td>")
			
			output:printLn("</tr>");

			index = index + 1
			totalSize = totalSize + rs:getInt32ByName("size")
			totalPols = totalPols + rs:getInt32ByName("polygonCount")
		end

		output:print("<tr class=\"total\">")
		output:print("<td>Total, " .. index .. " mesh(es)</td>")
		output:print("<td/>")
		output:print("<td>" .. totalPols .. "</td>")
		output:print("<td>" .. math.ceil(totalSize / 1024) .. " KiB</td>")
		output:print("</tr>")
--?>
		</table>
		<br/>
		<br/>
	</body>
</html>
