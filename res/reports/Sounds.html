<html>
	<head>
		<title>Sounds report</title>
		<style type="text/css">
			body {
				background-color: #e0e0d0;
				font-family: Tahoma;
				font-size: 80%;
			}
			table {
				background-color: #f0f0e0;
				border-style: none;
				border-collapse:collapse;
				font-size: 90%;
				width: 100%;
				text-align: left;
			}
			tr, td {
				border: 1px solid #a0a090;
			}
			tr.alt {
				border: 1px solid #a0a090;
				background-color: #e0e0d0;
			}
			tr.total {
				border-style: none;
				background-color: #f5f5e5;
				font-weight: bold;
			}
			th, td {
				padding: 2px;
			}
			th {
				background-color: #f5f5e5;
			}
		</style>
	</head>
	<body>
	
<h1>Sounds report</h1>
<?tap
	var db = Global.connect("fileName=$(REPORT_DB)");
?>	
		<table>
			<tr>
				<th>Path</th>
				<th>Type</th>
				<th>Preload</th>
				<th>Sample rate</th>
				<th>Channel(s)</th>
				<th>Size (KiB)</th>
			</tr>
<?tap
	var index = 0, totalStreamSize = 0, totalStaticSize = 0;
	
	var rs = db.executeQuery("select * from Report_Sound order by size desc");
	while (rs.next())
	{
		if (index % 2 == 1)
			Global.print("<tr class=\"alt\">");
		else
			Global.print("<tr>");
			
		var type = rs.getInt32ByName("type"), typeName = "";
		if (type == 0)
			typeName = "Stream";
		else
			typeName = "Static";
			
		var preload = rs.getInt32ByName("preload") ? "Yes" : "No";
	
		Global.print("<td>" + rs.getStringByName("path") + "</td>");
		Global.print("<td>" + typeName + "</td>");
		Global.print("<td>" + preload + "</td>");
		if (type != 0)
		{
			Global.print("<td>" + rs.getInt32ByName("sampleRate") + "</td>");
			Global.print("<td>" + rs.getInt32ByName("channelsCount") + "</td>");
		}
		else
		{
			Global.print("<td/><td/>");
		}
		Global.print("<td>" + Math.round(rs.getInt32ByName("size") / 1024) + "</td>");
		
		Global.printLn("</tr>");
		
		++index;
		
		if (type == 0)
			totalStreamSize += rs.getInt32ByName("size");
		else
			totalStaticSize += rs.getInt32ByName("size");
	}
	
	Global.print("<tr class=\"total\">");
	Global.print("<td>Total, " + index + " sounds(s)</td>");
	Global.print("<td/>");
	Global.print("<td/>");
	Global.print("<td/>");
	Global.print("<td/>");
	Global.print("<td>" + Math.round((totalStreamSize + totalStaticSize) / 1024) + " (Stream: " + Math.round((totalStreamSize) / 1024) + ", Static: " + Math.round((totalStaticSize) / 1024) + ")</td>");
	Global.printLn("</tr>");	
?>
		</table>
		<br/>
		<br/>
	</body>
</html>
